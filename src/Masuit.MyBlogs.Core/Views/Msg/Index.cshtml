@{
    ViewBag.Title = "留言板";
    Layout = "~/Views/Shared/_Layout.cshtml";
    string cid = string.IsNullOrEmpty(Context.Request.Query["cid"]) ? "0" : Context.Request.Query["cid"].ToString();
}
<link href="~/Assets/layui/css/layui.min.css" rel="stylesheet" />
<script src="~/Assets/layui/layui.all.js"></script>
<div class="container min-height610">
    <ol class="cd-breadcrumb triangle">
        <li><a asp-controller="Home" asp-action="Index">首页</a></li>
        <li class="current">
            <em>@ViewBag.Title</em>
        </li>
    </ol>
    <h3 class="size24">
        留言须知：
    </h3>
    <p>
        1. 尊重网上道德，严禁发表侮辱、诽谤、教唆、淫秽内容；
    </p>
    <p>
        2. 您在本站发表的任何言论，本站有权在网站内保留、转载、引用或者删除（被判为垃圾留言）；
    </p>
    <p>
        3. <span style="color: rgb(255, 0, 0);">请务必使用真实的邮箱地址参与回复</span>，非有效邮箱的回复不论内容，一律删除；
    </p>
    <p>
        4. <span style="color: rgb(255, 0, 0);">本站有反垃圾机制</span>，请保证每一次回复的内容质量，垃圾留言评判标准（包括但不仅限于）：
    </p>
    <p style=" text-indent: 2em;">
        昵称：商业推广信息（如带SEO、店铺字眼）、不文明、有攻击他人嫌疑的、不和谐的；
    </p>
    <p style=" text-indent: 2em;">
        邮件地址：很明显无效的邮件地址；
    </p>
    <p style=" text-indent: 2em;">
        链接：SEO、广告推广类网址一律视为垃圾留言处理；
    </p>
    <p style=" text-indent: 2em;">
        内容：包含广告内容，政治影射内容；
    </p>
    <p style=" text-indent: 2em;">
        提及、发表容易引起争论的言论或者观点（如：争论强度），虽然您的发言本质上并没有带有恶意，但可能因为观点的问题引起带有负面情绪的讨论。出现带有负面情绪的讨论时，为维持留言区的秩序，会被管理员删除相关发言。
    </p>
    <p>
        5. 多次发表垃圾留言将会被封禁账户或IP；封禁标准：
    </p>
    <p style="text-indent: 2em;">
        对于初次产生留言问题的用户，原则上不作直接封禁,直接删除问题发言内容；
    </p>
    <p style="text-indent: 2em;">
        用户发言不当，应该以删除为主管理，除非该用户多次或管理员提醒后，仍发表同类言论，则实施封禁；
    </p>
    <p style="text-indent: 2em;">
        初次封禁应适当从轻，一般不超过3天以上，初犯外的情况下，禁言天数不得大于上次被禁言天数的3倍；
    </p>
    <p style="text-indent: 2em;">
        包括但不限于 政治敏感、色情、暴力、人身攻击其他用户，现实人物，英灵从者与管理员、广告、刷屏等不良行为将被严厉封禁；
    </p>
    <p style="text-indent: 2em;">
        具体封禁操作取决于管理员的自行判断，所以具体标准以及期限请管理员自行斟酌。
    </p>
    <p>
        6. <span style="color: rgb(255, 0, 0);">为节省您的时间，请尽量不要留诸如“会不会...”、“是不是...”这样的能够自己一试便知的问题；</span>
    </p>
    <p>
        7. 本站不接受任何的个性化需求的求助类咨询，任何有关个性化需求的求助类问题一律不予回复，诸如“求...资源”等问题；
    </p>
    <p>
        8. <span style="color: rgb(255, 0, 0);">留言区不接受任何站内文章的相关评论和问题解决，相关问题请在原文评论区进行提交，否则一律作为垃圾留言处理；</span>
    </p>
    <p>
        9. 如果你有任何问题需要在留言区反馈，请在提交之前先尝试使用不同的关键词进行站内搜索，站内搜索能找到的内容留言区不予回复处理；
    </p>
    <p>
        10. 参与本站留言即表明您已经阅读并接受上述条款，对以上规则本站保留最终解释权。
    </p>
    <p>　</p>
    <form class="form-horizontal animated pulse" id="msg-form" method="post">
        @Html.AntiForgeryToken()
        <input type="hidden" name="OperatingSystem" id="OperatingSystem" />
        <input type="hidden" name="Browser" id="Browser" />
        <div class="row">
            <div class="col-md-4">
                <div class="input-group">
                    <span class="input-group-addon">
                        <label for="name">昵称：</label>
                    </span>
                    <input type="text" class="form-control" name="NickName" id="name" required placeholder="昵称">
                </div>
            </div>
            <div class="col-md-4">
                <div class="input-group">
                    <span class="input-group-addon">
                        <label for="email">邮箱：</label>
                    </span>
                    <input type="email" class="form-control" name="Email" id="email" required placeholder="留下您的真实邮箱，以方便接收回复">
                </div>
            </div>
            <div class="col-md-4">
                <div class="input-group">
                    <span class="input-group-addon">
                        <label for="chat">QQ/微信：</label>
                    </span>
                    <input type="text" class="form-control" name="QQorWechat" id="chat" placeholder="QQ或微信(可选)">
                </div>
            </div>
        </div>
        <div class="form-group overlay animated fadeInDown" style="margin-bottom: 0px !important;">
            <textarea class="layui-textarea" id="layedit" name="Content" style="height: 200px"></textarea>
        </div>
        <input type="checkbox" name="Agree" id="aggrement1" value="true" /><label for="aggrement1">我已接受<a asp-controller="Misc" asp-action="agreement" target="_blank">《留言须知》</a></label>
        <div class="form-group">
            <div class="col-xs-12">
                <button type="submit" class="btn btn-info btn-lg">
                    发表留言
                </button>
                <a class="text-red">留言框可粘贴网络图片</a>
            </div>
        </div>
    </form>
    <ul class="wow media-list"></ul>
    <div class="row">
        <div class="col-md-12 text-center">
            <div id="pageToolbar"></div>
        </div>
    </div>
</div>
<div style="position: fixed; left: -20000px; bottom: -20000px;">
    <div id="reply" class="container-fluid">
        <form class="form-horizontal" id="reply-form" method="post">
            @Html.AntiForgeryToken()
            <input type="hidden" name="OperatingSystem" id="OperatingSystem2" />
            <input type="hidden" name="Browser" id="Browser2" />
            <div class="input-group">
                <span class="input-group-addon">
                    <label for="name">昵称：</label>
                </span>
                <input type="text" class="form-control" name="NickName" id="name2" required placeholder="昵称">
            </div>
            <div class="input-group">
                <span class="input-group-addon">
                    <label for="email">邮箱：</label>
                </span>
                <input type="email" class="form-control" name="Email" id="email2" required placeholder="留下您的真实邮箱，以方便接收回复">
            </div>
            <div class="input-group">
                <span class="input-group-addon">
                    <label for="chat">QQ/微信：</label>
                </span>
                <input type="text" class="form-control animated pulse" name="QQorWechat" id="chat2" placeholder="QQ或微信(可选)">
            </div>
            <input type="hidden" value="" id="uid" name="ParentId" />
            <div class="form-group overlay">
                <textarea class="layui-textarea" id="layedit2" name="Content" style="height: 80px"></textarea>
            </div>
            <input type="checkbox" name="Agree" id="aggrement2" value="true" /><label for="aggrement2">我已接受<a asp-controller="Misc" asp-action="agreement" target="_blank">《留言须知》</a></label>
            <div class="form-group">
                <div class="col-xs-12">
                    <div class="btn-group">
                        <button type="submit" class="btn btn-info btn-lg">
                            提交回复
                        </button>
                        <button type="button" class="btn-cancel btn btn-danger btn-lg">
                            取消回复
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
<script src="~/Scripts/global/leavemsg.min.js"></script>
<script>
	window.onload = function() {
        loading();
		$('#pageToolbar').Paging({ //异步加载评论
			pagesize: 10,
			count: @ViewBag.TotalCount,
			toolbar: true,
			callback: function(page, size, count) {
				$.post("/msg/getmsgs", {
					page: page,
					size: size
                }, (data) => {
                    data = data.Data;
                    if (data) {
                        document.querySelector(".media-list").innerHTML = loadParentMsgs(data);
                        bindReplyBtn();
					}
				});
			}
		});
        loadingDone();
	};

	/**
   * 获取留言
   */
    function getmsgs() {
        $.post("/msg/getmsgs", {
            page: 1,
            size: 10,
            cid:@cid
        }, (data) => {
            data = data.Data;
			if (data) {
                document.querySelector(".media-list").innerHTML = loadParentMsgs(data);
                bindReplyBtn();
			}
        });
    }
</script>